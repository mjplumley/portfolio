<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="profile" href="http://gmpg.org/xfn/11">
<title>Neural Network XOR &#8211; Meredith Plumley</title>
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Meredith Plumley &raquo; Feed" href="https://mjplumley.github.io/portfolio/feed/" />
<link rel="alternate" type="application/rss+xml" title="Meredith Plumley &raquo; Comments Feed" href="https://mjplumley.github.io/portfolio/comments/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://mjplumley.github.io/portfolio/wp-includes/css/dist/block-library/style.min.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='amphibious-bootstrap-grid-css'  href='https://mjplumley.github.io/portfolio/wp-content/themes/amphibious/css/bootstrap-grid.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-5-css'  href='https://mjplumley.github.io/portfolio/wp-content/themes/amphibious/css/fontawesome-all.css?ver=5.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='amphibious-fonts-css'  href='https://fonts.googleapis.com/css?family=Poppins%3A400%2C400i%2C700%2C700i%7CRubik%3A400%2C400i%2C700%2C700i&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='amphibious-style-css'  href='https://mjplumley.github.io/portfolio/wp-content/themes/amphibious/style.css?ver=5.4.2' type='text/css' media='all' />
<style id='amphibious-style-inline-css' type='text/css'>
.blog .posted-on,.archive .posted-on,.search .posted-on,.blog .cat-links,.archive .cat-links,.search .cat-links,.blog .byline,.archive .byline,.search .byline,.blog .comments-link,.archive .comments-link,.search .comments-link,.single .posted-on,.single .cat-links,.single .tags-links,.single .byline,.archive-title-control,.credits-designer { clip: rect(1px, 1px, 1px, 1px); position: absolute; }
</style>
<script type='text/javascript' src='https://mjplumley.github.io/portfolio/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://mjplumley.github.io/portfolio/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='https://mjplumley.github.io/portfolio/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://mjplumley.github.io/portfolio/xmlrpc.php?rsd" />
<link rel='next' title='Recommender Problem: Netflix Data' href='https://mjplumley.github.io/portfolio/recommender-problem-netflix-data/' />
<meta name="generator" content="WordPress 5.4.2" />
<link rel="canonical" href="https://mjplumley.github.io/portfolio/neural-network-xor/" />
<link rel='shortlink' href='https://mjplumley.github.io/portfolio/?p=175' />
<link rel="alternate" type="application/json+oembed" href="https://mjplumley.github.io/portfolio/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmjplumley.github.io%2Fportfolio%2Fneural-network-xor%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://mjplumley.github.io/portfolio/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmjplumley.github.io%2Fportfolio%2Fneural-network-xor%2F&#038;format=xml" />

		<style type="text/css">
		.site-header {
			background-image: url(https://mjplumley.github.io/portfolio/wp-content/uploads/2020/05/cropped-background.jpg);
			background-repeat: no-repeat;
			background-position: top center;
			-webkit-background-size: cover;
			   -moz-background-size: cover;
			     -o-background-size: cover;
			        background-size: cover;
		}
	</style>
	
		<style type="text/css">
			.site-title a,
		.site-title a:visited {
			color: #ffffff;
		}
		.site-title a:hover,
		.site-title a:focus,
		.site-title a:active {
			opacity: 0.7;
		}
		.site-description {
			color: #ffffff;
			opacity: 0.7;
		}
		</style>

<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #44443f; }
</style>
	<link rel="icon" href="https://mjplumley.github.io/portfolio/wp-content/uploads/2020/05/cropped-LOGOmp-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://mjplumley.github.io/portfolio/wp-content/uploads/2020/05/cropped-LOGOmp-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://mjplumley.github.io/portfolio/wp-content/uploads/2020/05/cropped-LOGOmp-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://mjplumley.github.io/portfolio/wp-content/uploads/2020/05/cropped-LOGOmp-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#site-navigation-wrap .dropdown-menu {
    display: block;
    float: none;
    position: relative;
    top: auto;
    left: auto;
    border: none;
    border-radius: 0;
    -webkit-box-shadow: none;
    box-shadow: none;
}		</style>
		</head>
<body class="post-template-default single single-post postid-175 single-format-standard custom-background has-site-branding has-custom-header has-wide-layout has-left-sidebar">
<div id="page" class="site-wrapper site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
<header id="masthead" class="site-header">
	<div class="container">
		<div class="row">
			<div class="col">

				<div class="site-header-inside-wrapper">
					
<div class="site-branding-wrapper">
	<div class="site-logo-wrapper"></div>
	<div class="site-branding">
					<p class="site-title"><a href="https://mjplumley.github.io/portfolio/" title="Meredith Plumley" rel="home">Meredith Plumley</a></p>
		
				<p class="site-description">
			PhD Applied Mathematician 		</p>
			</div>
</div><!-- .site-branding-wrapper -->

<nav id="site-navigation" class="main-navigation">
	<div class="main-navigation-inside">
		<div class="toggle-menu-wrapper">
			<a href="#header-menu-responsive" title="Menu" class="toggle-menu-control">
				<span class="toggle-menu-label">Menu</span>
			</a>
		</div>

		<div class="site-header-menu-wrapper site-header-menu-responsive-wrapper"><ul id="menu-1" class="site-header-menu site-header-menu-responsive"><li id="menu-item-28" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-28"><a href="https://mjplumley.github.io/portfolio/">Projects</a></li>
<li id="menu-item-101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101"><a target="_blank" rel="noopener noreferrer" href="https://my.indeed.com/p/meredithp-9nqex5y">CV</a></li>
</ul></div>	</div><!-- .main-navigation-inside -->
</nav><!-- .main-navigation -->
				</div><!-- .site-header-inside-wrapper -->

			</div><!-- .col -->
		</div><!-- .row -->
	</div><!-- .container -->
</header><!-- #masthead -->

	<div id="content" class="site-content">

	<div class="site-content-inside">
		<div class="container">
			<div class="row">

				<div id="primary" class="content-area col-16 col-sm-16 col-md-16 col-lg-11 col-xl-11 col-xxl-11 order-lg-2 order-xl-2 order-xxl-2">
					<main id="main" class="site-main">

						<div id="post-wrapper" class="post-wrapper post-wrapper-single post-wrapper-single-post">
												
							
<div class="post-wrapper-hentry">
	<article id="post-175" class="post-175 post type-post status-publish format-standard has-post-thumbnail hentry category-all category-data-science category-python has-post-thumbnail-archive">
		<div class="post-content-wrapper post-content-wrapper-single post-content-wrapper-single-post">

			<div class="entry-image-wrapper-single"><figure class="post-thumbnail"><img width="695" height="479" src="https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/XOR_solutions.png" class="img-featured img-responsive wp-post-image" alt="" srcset="https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/XOR_solutions.png 695w, https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/XOR_solutions-300x207.png 300w" sizes="(max-width: 695px) 100vw, 695px" /></figure></div>
			<div class="entry-data-wrapper">
				<div class="entry-header-wrapper">
					<header class="entry-header">
						<h1 class="entry-title">Neural Network XOR</h1>					</header><!-- .entry-header -->

					<div class="entry-meta entry-meta-header-after">
						<span class="byline entry-meta-icon">by <span class="author vcard"><a class="entry-author-link url fn n" href="https://mjplumley.github.io/portfolio/author/mjplumley/" rel="author"><span class="entry-author-name">mjplumley</span></a></span></span><span class="posted-on entry-meta-icon"><span class="screen-reader-text">Posted on</span><a href="https://mjplumley.github.io/portfolio/neural-network-xor/" rel="bookmark"><time class="entry-date published" datetime="2020-01-01T14:45:27+00:00">January 1, 2020</time><time class="updated" datetime="2020-07-10T13:23:23+00:00">July 10, 2020</time></a></span>					</div><!-- .entry-meta -->
				</div><!-- .entry-header-wrapper -->

				<div class="entry-content">
					
<p>The &#8216;exclusive or &#8216; (XOR) is a simple problem that can be trained using Machine Learning techniques. Here I apply a simple 2 layer neural network written in python and solved using matrix math (no ML packages used) to investigate neural networks on a more fundamental level. </p>



<div class="wp-block-media-text alignwide is-stacked-on-mobile" style="grid-template-columns:22% auto"><figure class="wp-block-media-text__media"><img src="https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-10.51.48-AM.png" alt="" class="wp-image-188" srcset="https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-10.51.48-AM.png 998w, https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-10.51.48-AM-295x300.png 295w, https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-10.51.48-AM-768x782.png 768w" sizes="(max-width: 998px) 100vw, 998px" /></figure><div class="wp-block-media-text__content">
<p>The inputs and outputs of XOR are expressed in the image to the left.  There are four input vectors, which are made up of all the combinations of 0 and 1, such as (1,0),(0,1),(0,0), and (1,1).  The output of XOR is 1 if the two inputs are different [(1,0) and (0,1)] and 0 if the inputs are the same [(1,1) and (0,0)].  Thus the training set is 4 vectors.  </p>
</div></div>



<div style="height:27px" aria-hidden="true" class="wp-block-spacer"></div>



<p>If we investigate the solution space [0, 1] x [0, 1], there are many correct solutions to this problem.  The 4 corners of the space are constrained and the system can learn several weights that will give the correct solutions to the training set but with different solutions on the interior of the domain.</p>



<p>When 2 nodes are included in the hidden layer, the result will sometimes give a correct solution (below left) but sometimes not (below right).  Notice that only 2 of the 4 training vectors are correctly satisfied in the solution on the right. The weights are initialized randomly so it might be a function of those starting weights and hysteresis.  </p>



<figure class="wp-block-gallery columns-2 is-cropped"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img src="https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-11.07.44-AM.png" alt="" data-id="192" data-full-url="https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-11.07.44-AM.png" data-link="https://mjplumley.github.io/portfolio/2020/06/02/neural-network-xor/screen-shot-2020-06-03-at-11-07-44-am/#main" class="wp-image-192" srcset="https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-11.07.44-AM.png 850w, https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-11.07.44-AM-300x198.png 300w, https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-11.07.44-AM-768x508.png 768w" sizes="(max-width: 850px) 100vw, 850px" /></figure></li><li class="blocks-gallery-item"><figure><img src="https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-11.09.17-AM.png" alt="" data-id="191" class="wp-image-191" srcset="https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-11.09.17-AM.png 838w, https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-11.09.17-AM-300x200.png 300w, https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-11.09.17-AM-768x511.png 768w" sizes="(max-width: 838px) 100vw, 838px" /></figure></li></ul><figcaption class="blocks-gallery-caption"><span style="color:#c4edf0" class="has-inline-color">A correct (left) and incorrect (right) solution.</span></figcaption></figure>



<p>When 4 nodes are included in the hidden layer, the system no longer gets caught between solutions and consistently produces correct solutions. Examples of the many correct solutions are shown below.</p>



<figure class="wp-block-gallery aligncenter columns-2 is-cropped"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img src="https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-11.02.30-AM.png" alt="" data-id="190" class="wp-image-190" srcset="https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-11.02.30-AM.png 840w, https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-11.02.30-AM-300x200.png 300w, https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-11.02.30-AM-768x512.png 768w" sizes="(max-width: 840px) 100vw, 840px" /></figure></li><li class="blocks-gallery-item"><figure><img src="https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/XOR_solutions-1.png" alt="" data-id="195" data-link="https://mjplumley.github.io/portfolio/2020/06/02/neural-network-xor/xor_solutions-1/#main" class="wp-image-195" srcset="https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/XOR_solutions-1.png 695w, https://mjplumley.github.io/portfolio/wp-content/uploads/2020/06/XOR_solutions-1-300x207.png 300w" sizes="(max-width: 695px) 100vw, 695px" /></figure></li></ul><figcaption class="blocks-gallery-caption"><span style="color:#c4edf0" class="has-inline-color">All correct solutions.</span></figcaption></figure>



<hr class="wp-block-separator"/>



<h2 class="has-text-align-center"><strong>Code</strong></h2>



<h4><strong>Main File</strong></h4>



<pre class="wp-block-code"><code>import numpy as np
import random
import matplotlib.pyplot as plt
# NEED TO IMPORT THE NEURALNETWORK CLASS FILE

training_data = &#91; &#91;1,1,0], &#91;0,0,0],&#91;1,0,1],&#91;0,1,1]  ]
brain = NeuralNetwork(2,4,1)
# TRAINING IT FOR THE XOR 
for i in range(50000):
    r = np.floor(4*(random.random()))
    data = training_data&#91;int(r)] 
    brain.train(data&#91;:2],data&#91;2])
 
# PLOT THE RESULTS OVER THE &#91;0,1]x&#91;0,1] DOMAIN
x = y = np.arange(0, 1.0, 0.01)
X, Y = np.meshgrid(x, y)
Z = np.zeros(&#91;100,100])
for ptx in x:
    for pty in y:
        Z&#91;int(100*ptx + .01), int(100*pty + .01)] = brain.feed_forward(&#91;ptx,pty])
plt.contourf(X, Y, Z, 20, cmap='RdGy')
plt.colorbar();</code></pre>



<h4><strong>NeuralNetwork Class File</strong></h4>



<pre class="wp-block-code"><code>import numpy as np
import random

def sigmoid(x):
    return 1/(1 + np.exp(-x))


class NeuralNetwork:
    
    def __init__(self, numI, numH, numO, lr = 0.1):
        self.input_nodes =  numI
        self.hidden_nodes = numH
        self.output_nodes = numO
        
        self.weights_ih = np.random.rand(numH,numI)
        self.weights_ho = np.random.rand(numO,numH)
        
        self.bias_h = np.random.rand(numH)
        self.bias_o = np.random.rand(numO)
        self.lr = lr

        
    def feed_forward(self, inputs):
        hidden = np.dot(self.weights_ih,inputs)
        hidden = hidden + self.bias_h
        # ACTIVATION
        hidden = sigmoid(hidden) 
        
        output = np.dot(self.weights_ho, hidden)
        guess = sigmoid(output + self.bias_o)
        return guess
    
    
    def train(self, inputs, targets):
        # Feed forward in here to have the hidden 
        hidden = np.dot(self.weights_ih,inputs)
        hidden = hidden + self.bias_h
        # ACTIVATION
        hidden = sigmoid(hidden) 
        
        outputs = np.dot(self.weights_ho, hidden)
        outputs = sigmoid(outputs + self.bias_o)
        
        output_errors = targets - outputs
        gradient_output = outputs*(1-outputs)
        weights_ho_change = self.lr*np.outer(gradient_output* output_errors, hidden.T)
        self.weights_ho += weights_ho_change
        self.bias_o += self.lr*gradient_output*output_errors
        
        hidden_errors = np.dot(self.weights_ho.T, output_errors)
        gradient_hidden = hidden*(1-hidden)
        weights_ih_change = self.lr*np.outer(gradient_hidden* hidden_errors, inputs)
        self.weights_ih += weights_ih_change
        self.bias_h += self.lr*gradient_hidden*hidden_errors
        </code></pre>



<p></p>
									</div><!-- .entry-content -->

				<footer class="entry-meta entry-meta-footer">
					<span class="cat-links cat-links-single">Posted in <a href="https://mjplumley.github.io/portfolio/category/all/" rel="category tag">All</a>, <a href="https://mjplumley.github.io/portfolio/category/data-science/" rel="category tag">Data Science</a>, <a href="https://mjplumley.github.io/portfolio/category/python/" rel="category tag">Python</a></span>				</footer><!-- .entry-meta -->
			</div><!-- .entry-data-wrapper -->

		</div><!-- .post-content-wrapper -->
	</article><!-- #post-## -->
</div><!-- .post-wrapper-hentry -->

							
							
	<nav class="navigation post-navigation" role="navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-next"><a href="https://mjplumley.github.io/portfolio/recommender-problem-netflix-data/" rel="next"><span class="meta-nav">Next</span> <span class="post-title">Recommender Problem: Netflix Data</span></a></div></div>
	</nav>
							
												</div><!-- .post-wrapper -->

					</main><!-- #main -->
				</div><!-- #primary -->

				<div id="site-sidebar" class="sidebar-area col-16 col-sm-16 col-md-16 col-lg-5 col-xl-5 col-xxl-5 order-lg-1 order-xl-1 order-xxl-1">
	<div id="secondary" class="sidebar widget-area sidebar-widget-area" role="complementary">
		<aside id="nav_menu-4" class="widget widget_nav_menu"><div class="menu-my-menu-container"><ul id="menu-my-menu" class="menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-28"><a href="https://mjplumley.github.io/portfolio/">Projects</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101"><a target="_blank" rel="noopener noreferrer" href="https://my.indeed.com/p/meredithp-9nqex5y">CV</a></li>
</ul></div></aside>	</div><!-- .sidebar -->
</div><!-- .col-* columns of main sidebar -->

			</div><!-- .row -->
		</div><!-- .container -->
	</div><!-- .site-content-inside -->


	</div><!-- #content -->

	<footer id="colophon" class="site-footer">
		
<div class="site-info">
	<div class="site-info-inside">

		<div class="container">

			<div class="row">
				<div class="col">
					<div class="credits-wrapper">
						<div class="credits credits-blog"></div><div class="credits credits-designer">Amphibious Theme by <a href="https://templatepocket.com" title="TemplatePocket">TemplatePocket</a> <span>&sdot;</span> Powered by <a href="https://wordpress.org" title="WordPress">WordPress</a></div>					</div><!-- .credits -->
				</div><!-- .col -->
			</div><!-- .row -->

		</div><!-- .container -->

	</div><!-- .site-info-inside -->
</div><!-- .site-info -->
	</footer><!-- #colophon -->

</div><!-- #page .site-wrapper -->

<div class="overlay-effect"></div><!-- .overlay-effect -->

<script type='text/javascript' src='https://mjplumley.github.io/portfolio/wp-content/themes/amphibious/js/enquire.js?ver=2.1.6'></script>
<script type='text/javascript' src='https://mjplumley.github.io/portfolio/wp-content/themes/amphibious/js/fitvids.js?ver=1.1'></script>
<script type='text/javascript' src='https://mjplumley.github.io/portfolio/wp-content/themes/amphibious/js/hover-intent.js?ver=r7'></script>
<script type='text/javascript' src='https://mjplumley.github.io/portfolio/wp-content/themes/amphibious/js/superfish.js?ver=1.7.10'></script>
<script type='text/javascript' src='https://mjplumley.github.io/portfolio/wp-content/themes/amphibious/js/custom.js?ver=1.0'></script>
</body>
</html>
